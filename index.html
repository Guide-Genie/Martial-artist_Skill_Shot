<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Î¨¥ÎèÑÍ∞Ä Ïä§ÌÇ¨ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</title>
  <style>
    body {
      background-color: #1c1c1c;
      color: #eee;
      font-family: 'Noto Sans KR', sans-serif;
      padding: 20px;
    }
    .skill-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .skill {
      width: 80px;
      background-color: #333;
      border: 1px solid #555;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 6px;
      box-shadow: 0 0 6px #000;
    }
    .skill img {
      width: 48px;
      height: 48px;
    }
    .level-controls {
      display: flex;
      justify-content: center;
      gap: 4px;
    }
    .level-controls button {
      background: #666;
      color: #fff;
      border: none;
      width: 24px;
      height: 24px;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
    }
    .level-display {
      font-size: 13px;
      margin: 2px 0;
      text-align: center;
      white-space: nowrap;
    }
    .skill-name {
      font-size: 11px;
      text-align: center;
    }
    .restricted {
      color: orange;
    }
    .selector {
      margin-bottom: 12px;
    }
    select {
      padding: 4px 8px;
      font-size: 14px;
    }
    #resultArea {
      margin-top: 20px;
      font-size: 14px;
      line-height: 1.8;
    }
    #monsterHPDisplay {
      margin-top: 10px;
      font-size: 16px;
      color: #ffcc00;
    }
  </style>
</head>
<body>
  <h1>üß± Î¨¥ÎèÑÍ∞Ä Ïä§ÌÇ¨ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</h1>

  <div class="selector">
    <label for="race">Ï¢ÖÏ°± ÏÑ†ÌÉù: </label>
    <select id="race">
      <option value="Ìè¨Ïú†Î•ò">Ìè¨Ïú†Î•ò</option>
      <option value="Ï°∞Î•ò">Ï°∞Î•ò</option>
      <option value="ÌååÏ∂©Î•ò">ÌååÏ∂©Î•ò</option>
    </select>
    &nbsp;&nbsp;
    <label for="grade">ÏÇ¨ÎÉ•ÌÑ∞ Îì±Í∏â ÏÑ†ÌÉù: </label>
    <select id="grade"></select>
    <label for="monster">Î™¨Ïä§ÌÑ∞ ÏÑ†ÌÉù: </label>
    <select id="monster"></select>
  </div>

  <div id="monsterHPDisplay"></div>

  <div class="skill-grid" id="skillGrid"></div>

  <div id="resultArea"></div>

  <script>
            const skills = [
  { id: 'magu', name: 'ÎßàÍµ¨ÎïåÎ¶¨Í∏∞', race: 'Ìè¨Ïú†Î•ò', max: 10, img: 'images/magu.png', damage: [52137, 104274, 156411, 208548, 260685, 312822, 364959, 417096, 469233, 521370] },
  { id: 'yangson', name: 'ÏñëÏÜêÍ≥µÍ≤©', race: 'Ìè¨Ïú†Î•ò', max: 10, img: 'images/yangson.png', damage: [20275, 40550, 60825, 81037, 101294, 121550, 141806, 162062, 182319, 202750] },
  { id: 'jiyeol', name: 'ÏßÄÏó¥Ï∞∏', race: 'Ìè¨Ïú†Î•ò', max: 10, img: 'images/jiyeol.png', damage: [162206, 324412, 486618, 648824, 811030, 973236, 1135442, 1297648, 1459854, 1622060] },
  { id: 'jjogi', name: 'Ï™ºÍ∏∞', race: 'Ï°∞Î•ò', max: 10, img: 'images/jjogi.png', damage: [22488, 44972, 67458, 89942, 112427, 134913, 157399, 179885, 202371, 224857] },
  { id: 'maeui', name: 'Îß§ÏùòÏúÑÏÉÅ', race: 'Ï°∞Î•ò', max: 10, img: 'images/maeui.png', damage: [88269, 176538, 264807, 353076, 441345, 529614, 617883, 706152, 794421, 882690] },
  { id: 'wind', name: 'ÏúàÎìúÏâêÏù¥Ïª§', race: 'Ï°∞Î•ò', max: 10, img: 'images/wind.png', damage: [123576, 247152, 370728, 494304, 617880, 741456, 865032, 988608, 1112184, 1235760] },
  { id: 'tail', name: 'Íº¨Î¶¨ÏπòÍ∏∞', race: 'ÌååÏ∂©Î•ò', max: 10, img: 'images/tail.png', damage: [240680, 477268, 714579, 950927, 1188237, 1424585, 1661895, 1898725, 2135554, 2371901] },
  { id: 'claw', name: 'Ìï†ÌÄ¥Í∏∞', race: 'ÌååÏ∂©Î•ò', max: 10, img: 'images/claw.png', damage: [102980, 205857, 308736, 411612, 514490, 617368, 720245, 823123, 926001, 1028879] }
];

const monsterData = {
  "E": [
    { name: "Ïä¨ÎùºÏûÑ", hp: 1564 },
    { name: "ÌîÑÎ°úÍ∑∏", hp: 1691 },
    { name: "ÌÑ∞ÌãÄ", hp: 2002 },
    { name: "Ïä¨Îü¨Í∑∏", hp: 3582 },
    { name: "Î∞îÌÅ¨", hp: 3651 },
    { name: "ÌíçÌíçÏù¥", hp: 5654 },
    { name: "Ï¥åÏ¥å", hp: 6029 },
    { name: "Í∞ÄÏä§", hp: 7045 },
    { name: "ÏóêÏä§ÏΩîÎ™®Ïù¥Îìú", hp: 8257 },
    { name: "Ïò§Ìäú", hp: 7966 }
  ],
  "D": [
    { name: "Ïä¨ÎùºÏûÑ", hp: 4408 },
    { name: "ÌîÑÎ°úÍ∑∏", hp: 5086 },
    { name: "ÌÅ¨Îû©", hp: 5943 },
    { name: "ÌÑ∞ÌãÄ", hp: 6869 },
    { name: "Î¶¨Ïπò", hp: 7918 },
    { name: "Ïä¨Îü¨Í∑∏", hp: 8673 },
    { name: "Î∞îÌÅ¨", hp: 11016 },
    { name: "ÎßêÎØ∏Ïûò", hp: 10736 },
    { name: "ÌíçÌíçÏù¥", hp: 13034 },
    { name: "Í∞ÄÏä§", hp: 17734 },
    { name: "ÏóêÏä§ÏΩîÎ™®Ïù¥Îìú", hp: 21196 },
    { name: "Ïò§Ìäú", hp: 22030 },
    { name: "ÌÅ¨ÎùºÏºÑ", hp: 26487 }
  ],
  "C": [
    { name: "Ïä¨ÎùºÏûÑ", hp: 18186 },
    { name: "ÌîÑÎ°úÍ∑∏", hp: 18665 },
    { name: "ÌÅ¨Îû©", hp: 19739 },
    { name: "ÌÑ∞ÌãÄ", hp: 21700 },
    { name: "Î¶¨Ïπò", hp: 23102 },
    { name: "Ïä¨Îü¨Í∑∏", hp: 23606 },
    { name: "Î∞îÌÅ¨", hp: 28606 },
    { name: "ÎßêÎØ∏Ïûò", hp: 30348 },
    { name: "ÌíçÌíçÏù¥", hp: 32303 },
    { name: "Ï¥åÏ¥å", hp: 30648 },
    { name: "Í∞ÄÏä§", hp: 36681 },
    { name: "ÏóêÏä§ÏΩîÎ™®Ïù¥Îìú", hp: 39337 },
    { name: "Ïò§Ìäú", hp: 40502 },
    { name: "ÌÅ¨ÎùºÏºÑ", hp: 42160 }
  ],
  "B": [
    { name: "Ïò§Ìäú", hp: 56528 },
    { name: "ÏóêÏä§ÏΩîÎ™®Ïù¥Îìú", hp: 57299 },
    { name: "ÏöîÏò§Îã§", hp: 58560 },
    { name: "Ï¥åÏ¥å", hp: 59299 },
    { name: "Í∞ÄÏä§", hp: 59494 },
    { name: "Î∂ÄÎ£®Îßà", hp: 62547 },
    { name: "ÌÅ¨ÎùºÏºÑ", hp: 63491 },
    { name: "Í∑∏Î†òÎ¶∞", hp: 69553 }
  ],
  "A": [
    { name: "Ï¥åÏ¥å", hp: 176798 },
    { name: "Í∞ÄÏä§", hp: 273385 },
    { name: "ÏóêÏä§ÏΩîÎ™®Ïù¥Îìú", hp: 335914 },
    { name: "Ïò§Ìäú", hp: 413594 },
    { name: "ÌÅ¨ÎùºÏºÑ", hp: 440025 },
    { name: "Í∑∏Î†òÎ¶∞", hp: 451487 },
    { name: "ÏöîÏò§Îã§", hp: 478211 },
    { name: "Î∂ÄÎ£®Îßà", hp: 518903 }
  ],
  "S": [
    { name: "Ï¥åÏ¥å", hp: 993781 },
    { name: "Í≤ÄÏùÄÏ†ÑÍ∞à", hp: 1685782 },
    { name: "Î∂âÏùÄÍ∑∏ÎûòÎ∏å", hp: 2379253 },
    { name: "Î∂âÏùÄÌÑ∞ÌãÄ", hp: 3090120 },
    { name: "ÏöîÏò§Îã§", hp: 3186410 },
    { name: "Î∂ÄÎ£®Îßà", hp: 3652289 },
    { name: "Í∑∏Î†òÎ¶∞", hp: 4208420 },
    { name: "Î∂âÏùÄÎßêÎØ∏Ïûò", hp: 4536507 }
  ],
  "SS": [
    { name: "Ï¥åÏ¥å", hp: 4874967 },
    { name: "Î≥¥ÎùºÏ†ÑÍ∞à", hp: 5979141 },
    { name: "Ìë∏Î•∏ÌÑ∞ÌãÄ", hp: 6093503 },
    { name: "ÎÖπÎπõÍ∑∏ÎûòÎ∏å", hp: 7004127 },
    { name: "Î∂âÏùÄÎßêÎØ∏Ïûò", hp: 7542848 },
    { name: "Î∂ÄÎ£®Îßà", hp: 8119564 },
    { name: "Î∏îÎ£®Ìë∏ÏïÑ", hp: 9042696 },
    { name: "Ïñ¥ÎëêÏö¥ÎßêÎØ∏Ïûò", hp: 9584672 }
  ]
};

    const raceLimits = {
      'Ìè¨Ïú†Î•ò': { 'Ìè¨Ïú†Î•ò': 10, 'Ï°∞Î•ò': 4, 'ÌååÏ∂©Î•ò': 2 },
      'Ï°∞Î•ò': { 'Ìè¨Ïú†Î•ò': 4, 'Ï°∞Î•ò': 10, 'ÌååÏ∂©Î•ò': 2 },
      'ÌååÏ∂©Î•ò': { 'Ìè¨Ïú†Î•ò': 4, 'Ï°∞Î•ò': 4, 'ÌååÏ∂©Î•ò': 10 }
    };

    let selectedRace = localStorage.getItem('race') || 'Ìè¨Ïú†Î•ò';
    let currentLevels = JSON.parse(localStorage.getItem('levels') || '{}');
    let selectedMonster = null;

    function updateMonsterSelector() {
      const gradeSelect = document.getElementById('grade');
      const monsterSelect = document.getElementById('monster');
      monsterSelect.innerHTML = '';
      const monsters = monsterData[gradeSelect.value] || [];
      monsters.sort((a, b) => a.hp - b.hp);
      monsters.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m.name;
        opt.text = m.name;
        monsterSelect.appendChild(opt);
      });
      updateSelectedMonster();
    }

    function updateSelectedMonster() {
      const grade = document.getElementById('grade').value;
      const name = document.getElementById('monster').value;
      selectedMonster = monsterData[grade].find(m => m.name === name);
      document.getElementById('monsterHPDisplay').innerText = `üìå Î™¨Ïä§ÌÑ∞ Ï≤¥Î†•: ${selectedMonster.hp.toLocaleString()} HP`;
      renderSkills();
      calculateShots();
    }

    function renderSkills() {
      const skillGrid = document.getElementById('skillGrid');
      skillGrid.innerHTML = '';
      skills.forEach(skill => {
        const max = raceLimits[selectedRace][skill.race];
        const level = currentLevels[skill.id] || 0;

        const skillBox = document.createElement('div');
        skillBox.className = 'skill';

        const img = document.createElement('img');
        img.src = skill.img;
        img.alt = skill.name;
        skillBox.appendChild(img);

        const name = document.createElement('div');
        name.className = 'skill-name';
        name.innerText = skill.name;
        skillBox.appendChild(name);

        const levelText = document.createElement('div');
        levelText.className = 'level-display';
        if (skill.race !== selectedRace) levelText.classList.add('restricted');
        levelText.innerText = `${level}/${max}`;
        skillBox.appendChild(levelText);

        const damage = skill.damage[level - 1] || 0;
        const dmgText = document.createElement('div');
        dmgText.className = 'level-display';
        dmgText.innerHTML = `Îç∞ÎØ∏ÏßÄ<br>${damage.toLocaleString()}`;
        skillBox.appendChild(dmgText);

        const controls = document.createElement('div');
        controls.className = 'level-controls';

        const minus = document.createElement('button');
        minus.innerText = '-';
        minus.onclick = () => {
          if (currentLevels[skill.id] > 0) {
            currentLevels[skill.id]--;
            persist();
            renderSkills();
            calculateShots();
          }
        };

        const plus = document.createElement('button');
        plus.innerText = '+';
        plus.onclick = () => {
          if ((currentLevels[skill.id] || 0) < max) {
            currentLevels[skill.id] = (currentLevels[skill.id] || 0) + 1;
            persist();
            renderSkills();
            calculateShots();
          }
        };

        controls.appendChild(minus);
        controls.appendChild(plus);
        skillBox.appendChild(controls);

        skillGrid.appendChild(skillBox);
      });
    }

    function calculateShots() {
      const resultArea = document.getElementById('resultArea');
      if (!selectedMonster) return;

      const reusable = ['ÏñëÏÜêÍ≥µÍ≤©', 'Ï™ºÍ∏∞'];
      const skillsByDmg = skills.map(s => {
        const level = currentLevels[s.id] || 0;
        return {
          id: s.id,
          name: s.name,
          damage: s.damage[level - 1] || 0,
          level,
          cooldown: s.cooldown || 9999
        };
      }).filter(s => s.level > 0);

      const used = [];
      let remainingHP = selectedMonster.hp;
      let shotCount = 1;
      let output = [];

      while (remainingHP > 0) {
        let shot = [];
        let total = 0;
        let temp = [...skillsByDmg];
        temp.sort((a, b) => b.damage - a.damage);

        for (let skill of temp) {
          if (used.includes(skill.id) && !reusable.includes(skill.name)) continue;
          if (total + skill.damage <= remainingHP || reusable.includes(skill.name)) {
            shot.push(skill);
            total += skill.damage;
            if (!reusable.includes(skill.name)) used.push(skill.id);
          }
          if (total >= remainingHP) break;
        }

        output.push(`ÏÉ∑ ${shotCount++}: ${shot.map(s => `${s.name}(${s.damage.toLocaleString()})`).join(' + ')} = ${total.toLocaleString()} Îç∞ÎØ∏ÏßÄ`);
        remainingHP -= total;
        if (shot.length === 0) break;
      }

      if (remainingHP > 0) {
        output.push(`ü©∏ ÎÇ®ÏùÄ HP: ${remainingHP.toLocaleString()} ‚Äî Ïä§ÌÇ¨ Î∂ÄÏ°±`);
      }

      resultArea.innerHTML = output.map(line => `<div>${line}</div>`).join('');
    }

    function persist() {
      localStorage.setItem('levels', JSON.stringify(currentLevels));
      localStorage.setItem('race', selectedRace);
    }

    document.getElementById('race').addEventListener('change', (e) => {
      selectedRace = e.target.value;
      persist();
      renderSkills();
      calculateShots();
    });

    document.getElementById('grade').addEventListener('change', updateMonsterSelector);
    document.getElementById('monster').addEventListener('change', updateSelectedMonster);

    window.onload = () => {
      document.getElementById('grade').innerHTML = Object.keys(monsterData).map(g => `<option>${g}</option>`).join('');
      document.getElementById('race').value = selectedRace;
      updateMonsterSelector();
    }
  </script>
</body>
</html>
