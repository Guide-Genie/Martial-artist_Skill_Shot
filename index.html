<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬´ë„ê°€ ìŠ¤í‚¬ ì‹œë®¬ë ˆì´í„°</title>
  <style>
    body {
      background: #1e1e1e;
      color: #eee;
      font-family: 'Noto Sans KR', sans-serif;
      padding: 30px;
    }
    h1 {
      font-size: 2em;
      color: orange;
      margin-bottom: 10px;
    }
    .dropdowns, .skills {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .skill-card {
      background: #2a2a2a;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      min-width: 100px;
    }
    .skill-card img {
      width: 48px;
      height: 48px;
    }
    .damage {
      font-size: 0.9em;
      margin: 5px 0;
      white-space: pre-line;
    }
    .button-group button {
      background: #444;
      color: #fff;
      border: none;
      margin: 0 3px;
      padding: 5px 10px;
      font-size: 0.9em;
      cursor: pointer;
      border-radius: 5px;
    }
    select {
      padding: 5px;
      background: #333;
      color: #fff;
      border-radius: 5px;
      border: 1px solid #666;
    }
    .output {
      background: #111;
      padding: 15px;
      border-radius: 10px;
      margin-top: 15px;
      white-space: pre-line;
    }
    .highlight {
      color: gold;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>ğŸ“¦ ë¬´ë„ê°€ ìŠ¤í‚¬ ì‹œë®¬ë ˆì´í„°</h1>
  <div class="dropdowns">
    <label>ì¢…ì¡± ì„ íƒ: 
      <select id="raceSelect"></select>
    </label>
    <label>ì‚¬ëƒ¥í„° ë“±ê¸‰: 
      <select id="gradeSelect"></select>
    </label>
    <label>ëª¬ìŠ¤í„° ì„ íƒ: 
      <select id="monsterSelect"></select>
    </label>
  </div>
  <div id="monsterHpDisplay" class="highlight"></div>
  <div class="skills" id="skillsContainer"></div>
  <div class="output" id="resultArea"></div>

  <script>
         const skills = [
  { id: 'magu', name: 'ë§ˆêµ¬ë•Œë¦¬ê¸°', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/magu.png', damage: [52137, 104274, 156411, 208548, 260685, 312822, 364959, 417096, 469233, 521370] },
  { id: 'yangson', name: 'ì–‘ì†ê³µê²©', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/yangson.png', damage: [20275, 40550, 60825, 81037, 101294, 121550, 141806, 162062, 182319, 202750] },
  { id: 'jiyeol', name: 'ì§€ì—´ì°¸', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/jiyeol.png', damage: [162206, 324412, 486618, 648824, 811030, 973236, 1135442, 1297648, 1459854, 1622060] },
  { id: 'jjogi', name: 'ìª¼ê¸°', race: 'ì¡°ë¥˜', max: 10, img: 'images/jjogi.png', damage: [22488, 44972, 67458, 89942, 112427, 134913, 157399, 179885, 202371, 224857] },
  { id: 'maeui', name: 'ë§¤ì˜ìœ„ìƒ', race: 'ì¡°ë¥˜', max: 10, img: 'images/maeui.png', damage: [88269, 176538, 264807, 353076, 441345, 529614, 617883, 706152, 794421, 882690] },
  { id: 'wind', name: 'ìœˆë“œì‰ì´ì»¤', race: 'ì¡°ë¥˜', max: 10, img: 'images/wind.png', damage: [123576, 247152, 370728, 494304, 617880, 741456, 865032, 988608, 1112184, 1235760] },
  { id: 'tail', name: 'ê¼¬ë¦¬ì¹˜ê¸°', race: 'íŒŒì¶©ë¥˜', max: 10, img: 'images/tail.png', damage: [240680, 477268, 714579, 950927, 1188237, 1424585, 1661895, 1898725, 2135554, 2371901] },
  { id: 'claw', name: 'í• í€´ê¸°', race: 'íŒŒì¶©ë¥˜', max: 10, img: 'images/claw.png', damage: [102980, 205857, 308736, 411612, 514490, 617368, 720245, 823123, 926001, 1028879] }
];

const monsterData = {
  "A": [
    { name: "ì´Œì´Œ", hp: 176798 },
    { name: "ê°€ìŠ¤", hp: 273385 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 335914 },
    { name: "ì˜¤íŠœ", hp: 413594 },
    { name: "í¬ë¼ì¼„", hp: 440025 },
    { name: "ê·¸ë ˜ë¦°", hp: 451487 },
    { name: "ìš”ì˜¤ë‹¤", hp: 478211 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 518903 }
  ],
  "S": [
    { name: "ì´Œì´Œ", hp: 993781 },
    { name: "ê²€ì€ì „ê°ˆ", hp: 1685782 },
    { name: "ë¶‰ì€ê·¸ë˜ë¸Œ", hp: 2379253 },
    { name: "ë¶‰ì€í„°í‹€", hp: 3090120 },
    { name: "ìš”ì˜¤ë‹¤", hp: 3186410 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 3652289 },
    { name: "ê·¸ë ˜ë¦°", hp: 4208420 },
    { name: "ë¶‰ì€ë§ë¯¸ì˜", hp: 4536507 }
  ],
  "SS": [
    { name: "ì´Œì´Œ", hp: 4874967 },
    { name: "ë³´ë¼ì „ê°ˆ", hp: 5979141 },
    { name: "í‘¸ë¥¸í„°í‹€", hp: 6093503 },
    { name: "ë…¹ë¹›ê·¸ë˜ë¸Œ", hp: 7004127 },
    { name: "ë¶‰ì€ë§ë¯¸ì˜", hp: 7542848 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 8119564 },
    { name: "ë¸”ë£¨í‘¸ì•„", hp: 9042696 },
    { name: "ì–´ë‘ìš´ë§ë¯¸ì˜", hp: 9584672 }
  ]
};

    const cooldowns = {
      jiyeol: 34, tail: 28, wind: 22, maeui: 16,
      claw: 12, magu: 10, yangson: 4, jjogi: 4
    };

    let selectedSkills = {};
    let race = localStorage.getItem('race') || 'ì¡°ë¥˜';
    let grade = localStorage.getItem('grade') || 'A';
    let monster = localStorage.getItem('monster') || 'ì´Œì´Œ';

    const raceSelect = document.getElementById('raceSelect');
    const gradeSelect = document.getElementById('gradeSelect');
    const monsterSelect = document.getElementById('monsterSelect');

    const monsterHpDisplay = document.getElementById('monsterHpDisplay');
    const skillsContainer = document.getElementById('skillsContainer');
    const resultArea = document.getElementById('resultArea');

    function populateDropdown(select, values, currentValue) {
      select.innerHTML = '';
      values.forEach(v => {
        const opt = document.createElement('option');
        opt.value = v;
        opt.textContent = v;
        if (v === currentValue) opt.selected = true;
        select.appendChild(opt);
      });
    }

    function updateMonsterList() {
      const monsters = monsterData[grade] ? monsterData[grade].filter(m => skills.some(s => s.race === race)) : [];
      populateDropdown(monsterSelect, monsters.map(m => m.name), monster);
      updateMonsterHp();
    }

    function updateMonsterHp() {
      const data = monsterData[grade]?.find(m => m.name === monster);
      if (data) monsterHpDisplay.textContent = `ëª¬ìŠ¤í„° ì²´ë ¥: ${data.hp.toLocaleString()} HP`;
    }

    function renderSkills() {
      skillsContainer.innerHTML = '';
      skills.filter(s => s.race === race).forEach(skill => {
        const level = selectedSkills[skill.id] || 0;
        const dmg = skill.damage[level - 1] || 0;

        const div = document.createElement('div');
        div.className = 'skill-card';
        div.innerHTML = `
          <img src="${skill.img}" alt="${skill.name}"><br>
          ${skill.name} <br>
          <span class="damage">${level}/10\n${dmg.toLocaleString()} ë°ë¯¸ì§€</span>
          <div class="button-group">
            <button onclick="changeLevel('${skill.id}', -1)">-</button>
            <button onclick="changeLevel('${skill.id}', 1)">+</button>
          </div>
        `;
        skillsContainer.appendChild(div);
      });
    }

    function changeLevel(id, delta) {
      selectedSkills[id] = Math.max(0, Math.min(10, (selectedSkills[id] || 0) + delta));
      localStorage.setItem('skills', JSON.stringify(selectedSkills));
      renderSkills();
      calculateShots();
    }

    function calculateShots() {
      resultArea.textContent = '';
      const monsterHp = monsterData[grade]?.find(m => m.name === monster)?.hp || 1;
      let available = [];
      for (const s of skills) {
        const lv = selectedSkills[s.id] || 0;
        if (lv > 0 && s.race === race) {
          const dmg = s.damage[lv - 1];
          available.push({ id: s.id, name: s.name, dmg, cd: cooldowns[s.id] });
        }
      }

      available.sort((a, b) => b.dmg - a.dmg);

      let timeline = [], used = new Set();
      while (available.length) {
        let shot = [], total = 0;
        for (const skill of available) {
          if (!used.has(skill.id) || skill.cd <= 4) {
            if (total + skill.dmg <= monsterHp || shot.length === 0) {
              shot.push(skill);
              total += skill.dmg;
              if (skill.cd > 4) used.add(skill.id);
            }
          }
        }
        if (!shot.length) break;
        timeline.push({ shot, total });
      }

      timeline.forEach((line, i) => {
        const combo = line.shot.map(s => `${s.name}(${s.dmg.toLocaleString()})`).join(' + ');
        resultArea.textContent += `ìƒ· ${i + 1}: ${combo} = ì´ ${line.total.toLocaleString()} ë°ë¯¸ì§€\n`;
      });
    }

    function init() {
      populateDropdown(raceSelect, [...new Set(skills.map(s => s.race))], race);
      populateDropdown(gradeSelect, Object.keys(monsterData).filter(g => ['A', 'S', 'SS'].includes(g)), grade);
      selectedSkills = JSON.parse(localStorage.getItem('skills') || '{}');
      updateMonsterList();
      renderSkills();
      calculateShots();
    }

    raceSelect.onchange = () => {
      race = raceSelect.value;
      localStorage.setItem('race', race);
      updateMonsterList();
      renderSkills();
      calculateShots();
    };
    gradeSelect.onchange = () => {
      grade = gradeSelect.value;
      localStorage.setItem('grade', grade);
      updateMonsterList();
      calculateShots();
    };
    monsterSelect.onchange = () => {
      monster = monsterSelect.value;
      localStorage.setItem('monster', monster);
      updateMonsterHp();
      calculateShots();
    };

    window.onload = init;
  </script>
</body>
</html>
