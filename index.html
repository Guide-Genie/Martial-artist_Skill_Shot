<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>무도가 스킬 타임라인 조합기</title>
  <style>
    body { background: #1e1e1e; color: #eee; font-family: 'Noto Sans KR', sans-serif; padding: 30px; }
    h1 { font-size: 1.8em; color: #ff944d; margin-bottom: 10px; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-bottom: 20px; }
    select, input[type='number'] {
      padding: 5px 10px; font-size: 1em; border-radius: 5px; border: none;
    }
    .target-hp { font-size: 1.2em; color: #ffcc00; margin-top: 5px; }
    .skills, .timeline { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px; }
    .skill-block, .timeline-slot {
      padding: 10px; background: #333; border-radius: 10px; width: 100px;
      text-align: center; cursor: grab; border: 2px solid transparent;
    }
    .timeline-slot { background: #292929; min-height: 80px; justify-content: center; align-items: center; display: flex; flex-direction: column; }
    .highlight { border-color: #00ff00; box-shadow: 0 0 10px #00ff00; }
  </style>
</head>
<body>
  <h1>무도가 스킬 타임라인 조합기</h1>

  <div class="controls">
    <label>등급: 
      <select id="grade">
        <option>A</option>
        <option>S</option>
        <option>SS</option>
      </select>
    </label>
    <label>몬스터: 
      <select id="monster"></select>
    </label>
    <label>수동 체력 입력: 
      <input type="number" id="manualHp" placeholder="예: 176798" />
    </label>
  </div>

  <div class="target-hp">몬스터 체력: <span id="targetHp">0</span> HP</div>

  <h3>스킬 목록</h3>
  <div class="skills" id="skillList"></div>

  <h3>타임라인</h3>
  <div class="timeline" id="timeline"></div>

  <script>
    const monsterData = {
      "A": [
        { name: "촌촌", hp: 176798 },
        { name: "가스", hp: 273385 },
        { name: "에스코모이드", hp: 335914 },
        { name: "오튜", hp: 413594 },
        { name: "크라켄", hp: 440025 },
        { name: "요오다", hp: 478211 },
        { name: "그렘린", hp: 451487 },
        { name: "부루마", hp: 518903 }
      ],
      "S": [
        { name: "촌촌", hp: 993781 },
        { name: "검은전갈", hp: 1685782 },
        { name: "붉은그래브", hp: 2379253 },
        { name: "붉은터틀", hp: 3090120 },
        { name: "요오다", hp: 3186410 },
        { name: "부루마", hp: 3652289 },
        { name: "그렘린", hp: 4208420 },
        { name: "붉은말미잘", hp: 4536507 }
      ],
      "SS": [
        { name: "촌촌", hp: 4874967 },
        { name: "보라전갈", hp: 5979141 },
        { name: "푸른터틀", hp: 6093503 },
        { name: "녹빛그래브", hp: 7004127 },
        { name: "붉은말미잘", hp: 7542848 },
        { name: "부루마", hp: 8119564 },
        { name: "블루푸아", hp: 9042696 },
        { name: "어두운말미잘", hp: 9584672 }
      ]
    };

    const skills = [
      { name: "마구때리기", damage: 104274 },
      { name: "양손공격", damage: 40550 },
      { name: "지열참", damage: 324412 },
      { name: "쪼기", damage: 44972 },
      { name: "매의위상", damage: 176538 },
      { name: "윈드쉐이커", damage: 247152 },
      { name: "꼬리치기", damage: 477268 },
      { name: "할퀴기", damage: 205857 }
    ];

    let targetHp = 0;

    const gradeSelect = document.getElementById('grade');
    const monsterSelect = document.getElementById('monster');
    const targetHpSpan = document.getElementById('targetHp');
    const manualHp = document.getElementById('manualHp');

    gradeSelect.addEventListener('change', updateMonsterList);
    monsterSelect.addEventListener('change', updateTargetHp);
    manualHp.addEventListener('input', () => {
      if (manualHp.value) {
        targetHp = parseInt(manualHp.value);
        targetHpSpan.textContent = targetHp.toLocaleString();
      } else updateTargetHp();
    });

    function updateMonsterList() {
      const grade = gradeSelect.value;
      monsterSelect.innerHTML = '';
      monsterData[grade].forEach(m => {
        const opt = document.createElement('option');
        opt.value = m.hp;
        opt.textContent = m.name;
        monsterSelect.appendChild(opt);
      });
      updateTargetHp();
    }

    function updateTargetHp() {
      targetHp = parseInt(monsterSelect.value);
      targetHpSpan.textContent = targetHp.toLocaleString();
    }

    function renderSkills() {
      const list = document.getElementById('skillList');
      skills.forEach(skill => {
        const el = document.createElement('div');
        el.className = 'skill-block';
        el.draggable = true;
        el.dataset.damage = skill.damage;
        el.textContent = `${skill.name}\n${skill.damage.toLocaleString()} 데미지`;
        el.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', JSON.stringify(skill));
        });
        list.appendChild(el);
      });
    }

    function setupTimeline() {
      const timeline = document.getElementById('timeline');
      for (let i = 0; i < 10; i++) {
        const slot = document.createElement('div');
        slot.className = 'timeline-slot';
        slot.ondragover = e => e.preventDefault();
        slot.ondrop = e => {
          const skill = JSON.parse(e.dataTransfer.getData('text'));
          const skillEl = document.createElement('div');
          skillEl.textContent = `${skill.name}\n${skill.damage.toLocaleString()} 데미지`;
          skillEl.style.fontSize = '0.9em';
          slot.appendChild(skillEl);
          updateTimelineHighlight();
        }
        timeline.appendChild(slot);
      }
    }

    function updateTimelineHighlight() {
      const slots = document.querySelectorAll('.timeline-slot');
      slots.forEach(slot => {
        const total = [...slot.children].reduce((sum, child) => {
          const dmg = parseInt(child.textContent.split("\n")[1].replace(/[^\d]/g, ''));
          return sum + dmg;
        }, 0);
        slot.classList.toggle('highlight', total >= targetHp);
      });
    }

    // 초기 실행
    updateMonsterList();
    renderSkills();
    setupTimeline();
  </script>
</body>
</html>
