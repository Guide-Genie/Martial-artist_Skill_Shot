<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬´ë„ê°€ ìŠ¤í‚¬ ì‹œë®¬ë ˆì´í„°</title>
  <style>
    body {
      background-color: #1c1c1c;
      color: #eee;
      font-family: 'Noto Sans KR', sans-serif;
      padding: 20px;
    }
    .skill-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .skill {
      width: 80px;
      background-color: #333;
      border: 1px solid #444;
      border-radius: 5px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding-bottom: 24px;
    }
    .skill img {
      width: 60px;
      height: 60px;
    }
    .level-controls {
      position: absolute;
      bottom: 0;
      display: flex;
      justify-content: center;
      width: 100%;
      gap: 2px;
    }
    .level-controls button {
      background: #555;
      color: #fff;
      border: none;
      width: 20px;
      height: 20px;
      font-size: 12px;
      cursor: pointer;
    }
    .level-display {
      font-size: 12px;
      margin-top: 4px;
    }
    .skill-name {
      font-size: 12px;
      margin-top: 4px;
      text-align: center;
    }
    .restricted {
      color: orange;
    }
    .selector {
      margin-bottom: 20px;
    }
    select {
      padding: 4px 8px;
      font-size: 14px;
    }
    #comboResult {
      margin-top: 20px;
      padding: 10px;
      background: #2a2a2a;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>ğŸ§± ë¬´ë„ê°€ ìŠ¤í‚¬ ì‹œë®¬ë ˆì´í„°</h1>

  <div class="selector">
    <label for="race">ë‚´ ì¢…ì¡± ì„ íƒ: </label>
    <select id="race">
      <option value="í¬ìœ ë¥˜">í¬ìœ ë¥˜</option>
      <option value="ì¡°ë¥˜">ì¡°ë¥˜</option>
      <option value="íŒŒì¶©ë¥˜">íŒŒì¶©ë¥˜</option>
    </select>
  </div>

  <div class="selector">
    <label for="grade">ì‚¬ëƒ¥í„° ë“±ê¸‰ ì„ íƒ: </label>
    <select id="grade"></select>

    <label for="monster">ëª¬ìŠ¤í„° ì„ íƒ: </label>
    <select id="monster"></select>
  </div>

  <div class="skill-grid" id="skillGrid"></div>
  <div id="comboResult"></div>

  <script>
      const skills = [
  { id: 'magu', name: 'ë§ˆêµ¬ë•Œë¦¬ê¸°', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/magu.png', damage: [52137, 104274, 156411, 208548, 260685, 312822, 364959, 417096, 469233, 521370] },
  { id: 'yangson', name: 'ì–‘ì†ê³µê²©', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/yangson.png', damage: [20275, 40550, 60825, 81037, 101294, 121550, 141806, 162062, 182319, 202750] },
  { id: 'jiyeol', name: 'ì§€ì—´ì°¸', race: 'í¬ìœ ë¥˜', max: 10, img: 'images/jiyeol.png', damage: [162206, 324412, 486618, 648824, 811030, 973236, 1135442, 1297648, 1459854, 1622060] },
  { id: 'jjogi', name: 'ìª¼ê¸°', race: 'ì¡°ë¥˜', max: 10, img: 'images/jjogi.png', damage: [22488, 44972, 67458, 89942, 112427, 134913, 157399, 179885, 202371, 224857] },
  { id: 'maeui', name: 'ë§¤ì˜ìœ„ìƒ', race: 'ì¡°ë¥˜', max: 10, img: 'images/maeui.png', damage: [88269, 176538, 264807, 353076, 441345, 529614, 617883, 706152, 794421, 882690] },
  { id: 'wind', name: 'ìœˆë“œì‰ì´ì»¤', race: 'ì¡°ë¥˜', max: 10, img: 'images/wind.png', damage: [123576, 247152, 370728, 494304, 617880, 741456, 865032, 988608, 1112184, 1235760] },
  { id: 'tail', name: 'ê¼¬ë¦¬ì¹˜ê¸°', race: 'íŒŒì¶©ë¥˜', max: 10, img: 'images/tail.png', damage: [240680, 477268, 714579, 950927, 1188237, 1424585, 1661895, 1898725, 2135554, 2371901] },
  { id: 'claw', name: 'í• í€´ê¸°', race: 'íŒŒì¶©ë¥˜', max: 10, img: 'images/claw.png', damage: [102980, 205857, 308736, 411612, 514490, 617368, 720245, 823123, 926001, 1028879] }
];

const monsterData = {
  "E": [
    { name: "ìŠ¬ë¼ì„", hp: 1564 },
    { name: "í”„ë¡œê·¸", hp: 1691 },
    { name: "í„°í‹€", hp: 2002 },
    { name: "ìŠ¬ëŸ¬ê·¸", hp: 3582 },
    { name: "ë°”í¬", hp: 3651 },
    { name: "í’í’ì´", hp: 5654 },
    { name: "ì´Œì´Œ", hp: 6029 },
    { name: "ê°€ìŠ¤", hp: 7045 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 8257 },
    { name: "ì˜¤íŠœ", hp: 7966 }
  ],
  "D": [
    { name: "ìŠ¬ë¼ì„", hp: 4408 },
    { name: "í”„ë¡œê·¸", hp: 5086 },
    { name: "í¬ë©", hp: 5943 },
    { name: "í„°í‹€", hp: 6869 },
    { name: "ë¦¬ì¹˜", hp: 7918 },
    { name: "ìŠ¬ëŸ¬ê·¸", hp: 8673 },
    { name: "ë°”í¬", hp: 11016 },
    { name: "ë§ë¯¸ì˜", hp: 10736 },
    { name: "í’í’ì´", hp: 13034 },
    { name: "ê°€ìŠ¤", hp: 17734 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 21196 },
    { name: "ì˜¤íŠœ", hp: 22030 },
    { name: "í¬ë¼ì¼„", hp: 26487 }
  ],
  "C": [
    { name: "ìŠ¬ë¼ì„", hp: 18186 },
    { name: "í”„ë¡œê·¸", hp: 18665 },
    { name: "í¬ë©", hp: 19739 },
    { name: "í„°í‹€", hp: 21700 },
    { name: "ë¦¬ì¹˜", hp: 23102 },
    { name: "ìŠ¬ëŸ¬ê·¸", hp: 23606 },
    { name: "ë°”í¬", hp: 28606 },
    { name: "ë§ë¯¸ì˜", hp: 30348 },
    { name: "í’í’ì´", hp: 32303 },
    { name: "ì´Œì´Œ", hp: 30648 },
    { name: "ê°€ìŠ¤", hp: 36681 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 39337 },
    { name: "ì˜¤íŠœ", hp: 40502 },
    { name: "í¬ë¼ì¼„", hp: 42160 }
  ],
  "B": [
    { name: "ì˜¤íŠœ", hp: 56528 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 57299 },
    { name: "ìš”ì˜¤ë‹¤", hp: 58560 },
    { name: "ì´Œì´Œ", hp: 59299 },
    { name: "ê°€ìŠ¤", hp: 59494 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 62547 },
    { name: "í¬ë¼ì¼„", hp: 63491 },
    { name: "ê·¸ë ˜ë¦°", hp: 69553 }
  ],
  "A": [
    { name: "ì´Œì´Œ", hp: 176798 },
    { name: "ê°€ìŠ¤", hp: 273385 },
    { name: "ì—ìŠ¤ì½”ëª¨ì´ë“œ", hp: 335914 },
    { name: "ì˜¤íŠœ", hp: 413594 },
    { name: "í¬ë¼ì¼„", hp: 440025 },
    { name: "ê·¸ë ˜ë¦°", hp: 451487 },
    { name: "ìš”ì˜¤ë‹¤", hp: 478211 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 518903 }
  ],
  "S": [
    { name: "ì´Œì´Œ", hp: 993781 },
    { name: "ê²€ì€ì „ê°ˆ", hp: 1685782 },
    { name: "ë¶‰ì€ê·¸ë˜ë¸Œ", hp: 2379253 },
    { name: "ë¶‰ì€í„°í‹€", hp: 3090120 },
    { name: "ìš”ì˜¤ë‹¤", hp: 3186410 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 3652289 },
    { name: "ê·¸ë ˜ë¦°", hp: 4208420 },
    { name: "ë¶‰ì€ë§ë¯¸ì˜", hp: 4536507 }
  ],
  "SS": [
    { name: "ì´Œì´Œ", hp: 4874967 },
    { name: "ë³´ë¼ì „ê°ˆ", hp: 5979141 },
    { name: "í‘¸ë¥¸í„°í‹€", hp: 6093503 },
    { name: "ë…¹ë¹›ê·¸ë˜ë¸Œ", hp: 7004127 },
    { name: "ë¶‰ì€ë§ë¯¸ì˜", hp: 7542848 },
    { name: "ë¶€ë£¨ë§ˆ", hp: 8119564 },
    { name: "ë¸”ë£¨í‘¸ì•„", hp: 9042696 },
    { name: "ì–´ë‘ìš´ë§ë¯¸ì˜", hp: 9584672 }
  ]
};
    const cooldowns = {
      jiyeol: 34, tail: 28, wind: 22, maeui: 16,
      claw: 12, magu: 10, yangson: 4, jjogi: 4
    };
    const isRepeatable = ['yangson', 'jjogi'];

    const raceLimits = {
      'í¬ìœ ë¥˜': { 'í¬ìœ ë¥˜': 10, 'ì¡°ë¥˜': 4, 'íŒŒì¶©ë¥˜': 2 },
      'ì¡°ë¥˜': { 'í¬ìœ ë¥˜': 4, 'ì¡°ë¥˜': 10, 'íŒŒì¶©ë¥˜': 2 },
      'íŒŒì¶©ë¥˜': { 'í¬ìœ ë¥˜': 4, 'ì¡°ë¥˜': 4, 'íŒŒì¶©ë¥˜': 10 }
    };

    let selectedRace = 'í¬ìœ ë¥˜';
    let selectedLevels = {};
    let selectedMonsterHp = 0;

    document.getElementById('race').addEventListener('change', e => {
      selectedRace = e.target.value;
      renderSkills();
      if (selectedMonsterHp > 0) calculateAndShowCombo(selectedMonsterHp, selectedLevels);
    });

    document.getElementById('grade').addEventListener('change', e => {
      const mons = monsterData[e.target.value];
      const monsterSelect = document.getElementById('monster');
      monsterSelect.innerHTML = '';
      mons.forEach(mon => {
        const opt = document.createElement('option');
        opt.value = mon.hp;
        opt.innerText = mon.name;
        monsterSelect.appendChild(opt);
      });
      selectedMonsterHp = parseInt(monsterSelect.value);
      calculateAndShowCombo(selectedMonsterHp, selectedLevels);
    });

    document.getElementById('monster').addEventListener('change', e => {
      selectedMonsterHp = parseInt(e.target.value);
      calculateAndShowCombo(selectedMonsterHp, selectedLevels);
    });

    function renderSkills() {
      const skillGrid = document.getElementById('skillGrid');
      skillGrid.innerHTML = '';
      selectedLevels = {};

      skills.forEach(skill => {
        const container = document.createElement('div');
        container.className = 'skill';
        container.id = skill.id;

        const img = document.createElement('img');
        img.src = skill.img;
        img.alt = skill.name;

        const label = document.createElement('div');
        label.className = 'skill-name';
        label.innerText = skill.name;

        const levelDisplay = document.createElement('div');
        levelDisplay.className = 'level-display';
        let cur = 0;
        const maxLevel = raceLimits[selectedRace][skill.race];
        if (skill.race !== selectedRace) levelDisplay.classList.add('restricted');
        levelDisplay.innerText = `${cur}/${maxLevel}`;

        selectedLevels[skill.id] = cur;

        const controls = document.createElement('div');
        controls.className = 'level-controls';

        const minus = document.createElement('button');
        minus.innerText = '-';
        minus.onclick = () => {
          if (cur > 0) {
            cur--;
            selectedLevels[skill.id] = cur;
            levelDisplay.innerText = `${cur}/${maxLevel}`;
            if (selectedMonsterHp > 0) calculateAndShowCombo(selectedMonsterHp, selectedLevels);
          }
        };

        const plus = document.createElement('button');
        plus.innerText = '+';
        plus.onclick = () => {
          if (cur < maxLevel) {
            cur++;
            selectedLevels[skill.id] = cur;
            levelDisplay.innerText = `${cur}/${maxLevel}`;
            if (selectedMonsterHp > 0) calculateAndShowCombo(selectedMonsterHp, selectedLevels);
          }
        };

        controls.appendChild(minus);
        controls.appendChild(plus);

        container.appendChild(img);
        container.appendChild(label);
        container.appendChild(levelDisplay);
        container.appendChild(controls);
        skillGrid.appendChild(container);
      });
    }

    function getAvailableSkills(exclude, levels) {
      return skills
        .filter(s => levels[s.id] > 0 && (!exclude.has(s.id) || isRepeatable.includes(s.id)))
        .map(s => ({ id: s.id, name: s.name, dmg: s.damage[levels[s.id] - 1], repeatable: isRepeatable.includes(s.id) }))
        .sort((a, b) => b.dmg - a.dmg);
    }

    function findShotCombos(monsterHp, levels) {
      const results = [];
      const used = new Set();
      let remainingHp = monsterHp;

      while (remainingHp > 0) {
        const combo = [];
        const usedThis = new Set();
        const candidates = getAvailableSkills(used, levels);
        let total = 0;

        for (let skill of candidates) {
          if (total >= remainingHp) break;
          combo.push(skill);
          total += skill.dmg;
          if (!skill.repeatable) usedThis.add(skill.id);
        }

        if (combo.length === 0) break;

        results.push({
          skills: combo,
          total,
          remaining: Math.max(remainingHp - total, 0)
        });

        remainingHp -= total;
        for (let id of usedThis) used.add(id);
      }

      return results;
    }

    function calculateAndShowCombo(monsterHp, levels) {
      const combos = findShotCombos(monsterHp, levels);
      const resultDiv = document.getElementById('comboResult');
      resultDiv.innerHTML = '';

      combos.forEach((combo, idx) => {
        const skillsText = combo.skills.map(s => `${s.name}(${s.dmg})`).join(' + ');
        const line = document.createElement('div');
        line.innerText = `ìƒ· ${idx + 1}: ${skillsText} = ì´ ${combo.total} ë°ë¯¸ì§€, ë‚¨ì€ HP: ${combo.remaining}`;
        resultDiv.appendChild(line);
      });

      if (combos.length === 0) {
        resultDiv.innerText = 'ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í‚¬ë¡œ ì¡°í•©ì„ ë§Œë“¤ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
      }
    }

    function populateMonsterDropdown() {
      const gradeSelect = document.getElementById('grade');
      for (let grade in monsterData) {
        const opt = document.createElement('option');
        opt.value = grade;
        opt.innerText = grade + 'ë“±ê¸‰';
        gradeSelect.appendChild(opt);
      }
    }

    populateMonsterDropdown();
    renderSkills();
  </script>
</body>
</html>
