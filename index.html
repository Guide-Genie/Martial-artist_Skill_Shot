<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>무도가 스킬 시뮬레이터</title>
  <style>
    body {
      background-color: #1c1c1c;
      color: #eee;
      font-family: 'Noto Sans KR', sans-serif;
      padding: 20px;
    }
    h1 {
      font-size: 24px;
      color: #ffcc00;
    }
    .selector {
      margin-bottom: 10px;
    }
    select {
      padding: 4px 8px;
      font-size: 14px;
    }
    #monsterHPDisplay {
      margin: 10px 0;
      font-size: 16px;
      color: #ffcc00;
    }
    .skill-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    .skill {
      width: 80px;
      background-color: #333;
      border: 1px solid #555;
      border-radius: 8px;
      padding: 6px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .skill img {
      width: 48px;
      height: 48px;
    }
    .skill-name {
      font-size: 12px;
      text-align: center;
      margin-top: 4px;
    }
    .level-display {
      font-size: 12px;
      margin: 2px 0;
      white-space: pre-line;
      text-align: center;
    }
    .level-controls {
      display: flex;
      justify-content: center;
      gap: 4px;
    }
    .level-controls button {
      width: 24px;
      height: 24px;
      font-size: 14px;
      background-color: #666;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    #resultArea {
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>🧱 무도가 스킬 시뮬레이터</h1>
  <div class="selector">
    <label for="grade">등급 선택:</label>
    <select id="grade"></select>
    <label for="monster">몬스터 선택:</label>
    <select id="monster"></select>
  </div>
  <div id="monsterHPDisplay"></div>
  <div class="skill-grid" id="skillGrid"></div>
  <div id="resultArea"></div>

  <script>
            const skills = [
  { id: 'magu', name: '마구때리기', race: '포유류', max: 10, img: 'images/magu.png', damage: [52137, 104274, 156411, 208548, 260685, 312822, 364959, 417096, 469233, 521370] },
  { id: 'yangson', name: '양손공격', race: '포유류', max: 10, img: 'images/yangson.png', damage: [20275, 40550, 60825, 81037, 101294, 121550, 141806, 162062, 182319, 202750] },
  { id: 'jiyeol', name: '지열참', race: '포유류', max: 10, img: 'images/jiyeol.png', damage: [162206, 324412, 486618, 648824, 811030, 973236, 1135442, 1297648, 1459854, 1622060] },
  { id: 'jjogi', name: '쪼기', race: '조류', max: 10, img: 'images/jjogi.png', damage: [22488, 44972, 67458, 89942, 112427, 134913, 157399, 179885, 202371, 224857] },
  { id: 'maeui', name: '매의위상', race: '조류', max: 10, img: 'images/maeui.png', damage: [88269, 176538, 264807, 353076, 441345, 529614, 617883, 706152, 794421, 882690] },
  { id: 'wind', name: '윈드쉐이커', race: '조류', max: 10, img: 'images/wind.png', damage: [123576, 247152, 370728, 494304, 617880, 741456, 865032, 988608, 1112184, 1235760] },
  { id: 'tail', name: '꼬리치기', race: '파충류', max: 10, img: 'images/tail.png', damage: [240680, 477268, 714579, 950927, 1188237, 1424585, 1661895, 1898725, 2135554, 2371901] },
  { id: 'claw', name: '할퀴기', race: '파충류', max: 10, img: 'images/claw.png', damage: [102980, 205857, 308736, 411612, 514490, 617368, 720245, 823123, 926001, 1028879] }
];
    const monsterData = {
      "A": [
        { name: "촌촌", hp: 176798 },
        { name: "가스", hp: 273385 },
        { name: "에스코모이드", hp: 335914 },
        { name: "오튜", hp: 413594 },
        { name: "크라켄", hp: 440025 },
        { name: "그렘린", hp: 451487 },
        { name: "요오다", hp: 478211 },
        { name: "부루마", hp: 518903 }
      ],
      "S": [
        { name: "촌촌", hp: 993781 },
        { name: "검은전갈", hp: 1685782 },
        { name: "붉은그래브", hp: 2379253 },
        { name: "붉은터틀", hp: 3090120 },
        { name: "요오다", hp: 3186410 },
        { name: "부루마", hp: 3652289 },
        { name: "그렘린", hp: 4208420 },
        { name: "붉은말미잘", hp: 4536507 }
      ],
      "SS": [
        { name: "촌촌", hp: 4874967 },
        { name: "보라전갈", hp: 5979141 },
        { name: "푸른터틀", hp: 6093503 },
        { name: "녹빛그래브", hp: 7004127 },
        { name: "붉은말미잘", hp: 7542848 },
        { name: "부루마", hp: 8119564 },
        { name: "블루푸아", hp: 9042696 },
        { name: "어두운말미잘", hp: 9584672 }
      ]
    };

    let selectedMonster = null;
    let currentLevels = JSON.parse(localStorage.getItem("skillLevels") || "{}");

    function updateSelectors() {
      const gradeSel = document.getElementById("grade");
      const monsterSel = document.getElementById("monster");
      gradeSel.innerHTML = Object.keys(monsterData).map(g => `<option>${g}</option>`).join("");
      gradeSel.value = Object.keys(monsterData)[0];
      updateMonsters();
    }

    function updateMonsters() {
      const grade = document.getElementById("grade").value;
      const monsters = monsterData[grade] || [];
      const monsterSel = document.getElementById("monster");
      monsterSel.innerHTML = monsters.map(m => `<option>${m.name}</option>`).join("");
      monsterSel.value = monsters[0].name;
      updateSelectedMonster();
    }

    function updateSelectedMonster() {
      const grade = document.getElementById("grade").value;
      const name = document.getElementById("monster").value;
      selectedMonster = monsterData[grade].find(m => m.name === name);
      document.getElementById("monsterHPDisplay").innerText = `📌 몬스터 체력: ${selectedMonster.hp.toLocaleString()} HP`;
      calculateShots();
    }

    function renderSkills() {
      const grid = document.getElementById("skillGrid");
      grid.innerHTML = "";
      skills.forEach(skill => {
        const box = document.createElement("div");
        box.className = "skill";

        const img = document.createElement("img");
        img.src = skill.img;
        box.appendChild(img);

        const name = document.createElement("div");
        name.className = "skill-name";
        name.innerText = skill.name;
        box.appendChild(name);

        const level = currentLevels[skill.id] || 0;
        const damage = skill.damage[level - 1] || 0;

        const display = document.createElement("div");
        display.className = "level-display";
        display.innerText = `${level}/${skill.max}\n${damage.toLocaleString()}\n데미지`;
        box.appendChild(display);

        const controls = document.createElement("div");
        controls.className = "level-controls";

        const minus = document.createElement("button");
        minus.innerText = "-";
        minus.onclick = () => {
          if (currentLevels[skill.id] > 0) {
            currentLevels[skill.id]--;
            localStorage.setItem("skillLevels", JSON.stringify(currentLevels));
            renderSkills();
            calculateShots();
          }
        };

        const plus = document.createElement("button");
        plus.innerText = "+";
        plus.onclick = () => {
          if (currentLevels[skill.id] < skill.max) {
            currentLevels[skill.id] = (currentLevels[skill.id] || 0) + 1;
            localStorage.setItem("skillLevels", JSON.stringify(currentLevels));
            renderSkills();
            calculateShots();
          }
        };

        controls.appendChild(minus);
        controls.appendChild(plus);
        box.appendChild(controls);

        grid.appendChild(box);
      });
    }

    function calculateShots() {
      const resultArea = document.getElementById("resultArea");
      if (!selectedMonster) return;

      let remainingHP = selectedMonster.hp;
      const usable = skills.map(s => {
        const level = currentLevels[s.id] || 0;
        return level > 0 ? {
          id: s.id,
          name: s.name,
          damage: s.damage[level - 1],
          cooldown: s.cooldown || 0
        } : null;
      }).filter(Boolean);

      const reusable = ["양손공격", "쪼기"];
      const output = [];
      let shot = 1;

      while (remainingHP > 0 && usable.length > 0) {
        let total = 0;
        const used = [];

        for (const s of usable) {
          if (reusable.includes(s.name) || !used.includes(s.name)) {
            if (total + s.damage <= remainingHP || total === 0) {
              total += s.damage;
              used.push(s.name);
              if (!reusable.includes(s.name)) usable.splice(usable.findIndex(x => x.id === s.id), 1);
              if (total >= remainingHP) break;
            }
          }
        }

        output.push(`샷 ${shot++}: ${used.join(' + ')} = ${total.toLocaleString()} 데미지, 남은 HP: ${Math.max(0, remainingHP - total).toLocaleString()}`);
        remainingHP -= total;
      }

      if (remainingHP > 0) {
        output.push(`🩸 남은 체력: ${remainingHP.toLocaleString()} — 스킬 부족`);
      }

      resultArea.innerHTML = output.map(line => `<div>${line}</div>`).join('');
    }

    document.getElementById("grade").addEventListener("change", updateMonsters);
    document.getElementById("monster").addEventListener("change", updateSelectedMonster);
    window.onload = () => {
      updateSelectors();
      renderSkills();
    };
  </script>
</body>
</html>
